!function(){function n(n,t,r){var e,a,o=t.x,u=t.y,i=o.length,f=u.length;for(e=0;f>e;e++)for(a=0;i>a;a++)n[i*e+a]=r(o[e],u[a]);return n}function t(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=0;for(r=0;e>r;r++)a+=Math.abs(n[r]-t[r]);return a}function r(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=0;for(r=0;e>r;r++)a+=(n[r]-t[r])*(n[r]-t[r]);return Math.sqrt(a)}function e(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=[];for(r=0;e>r;r++)a.push(Math.abs(n[r]-t[r]));return Math.max.apply(null,a)}function a(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=[];for(r=0;e>r;r++)a.push(Math.abs(n[r]-t[r]));return Math.min.apply(null,a)}function o(n,t){var r,e=n.length,a=0;for(r=0;e>r;r++)a+=n[r]===t[r]?0:1;return a}var u={version:"1.0.0"};u.crp=function(){function t(n,t){for(var r=n.length,e=0;r>e;++e)n[e]=t}function r(n){var t=c*g;d=n,v=new Float32Array(t),s=new Uint8Array(c),m=new Uint8Array(c),p=!0,b=new ArrayBuffer(4*t),w=new Uint8ClampedArray(b),x=new Uint32Array(b),q.globalCompositeOperation="source-over",q.imageSmoothingEnabled=!1,C.imageSmoothingEnabled=!1,y=C.getImageData(0,0,c,g)}function e(n,t){return c=t.x.length,g=t.y.length,A=document.createElement("canvas"),A.width=c,A.height=g,C=A.getContext("2d"),M=n.append("canvas").attr("width",R).attr("height",D).node(),q=M.getContext("2d"),q.translate(0,M.height),q.scale(1,-1),r(t),f(),i(),e}function a(){y.data.set(w),C.putImageData(y,0,0),U=!1}function o(){v=n(v,d,I),t(m,0),u.toimg(v,x,c,g,E,m),p=!1,U=!0}function i(){p===!0&&o(),U===!0&&a();var n=l.domain(),t=l.range(),r=h.domain(),e=h.range();q.clearRect(0,0,M.width,M.height),q.drawImage(A,n[0],r[0],n[1]-n[0],r[1]-r[0],t[0],e[0],t[1]-t[0],e[1]-e[0])}function f(){l=d3.scale.linear().domain([0,c]).range([0,R]),h=d3.scale.linear().domain([0,g]).range([0,D])}var l,h,c,g,s,m,d=null,v=null,p=!0,y=null,b=null,w=null,x=null,M=null,A=null,U=!0,q=null,C=null,E=.5,I=u.norms.l2,R=100,D=100;return e.rqa=function(){return v?u.rqa(v,d.x.length,E):void 0},e.epsnet=function(){return m},e.resetHighlight=function(){return U=!0,t(s,0),u.toimg(v,x,c,g,E,m),i(),s},e.boxHighlight=function(n){if(U=!0,!arguments.length)return i(),s;t(s,0);var r,e,a,o,u,f=n[0][0]-.5,l=n[0][1]-.5,h=n[1][0]-.5,m=n[1][1]-.5,d=x,p=v,y=[255,0,0];for(o=0;g>o;o++)for(u=0;c>u;u++)r=c*o+u,a=p[r]<=E?255:0,e=!(l>o||o>m||f>u||u>h),e&&(s[u]=s[o]=1),d[r]=e===!0?255<<24|.5*(a+y[2])<<16|.5*(a+y[1])<<8|.5*(a+y[0]):255<<24|a<<16|a<<8|a;return i(),s},e.update=function(){return null!==d&&i(),e},e.distfn=function(n){if(!arguments.length)return I;var t=typeof n;return"string"===t?(I="undefined"!==u.norms[n]?u.norms[n]:u.norms.l2,p=!0):"function"===t?(I=n,p=!0):(console.warn("Incorrect form of the distance function!"),console.warn("Reverting back to the default, Euclidean distance")),e},e.eps=function(n){return arguments.length?(E=+n,p=!0,e):E},e.width=function(n){return arguments.length?(R=+n,e):R},e.height=function(n){return arguments.length?(D=+n,e):D},e.scale=function(n){return arguments.length?(l=n.xs(),h=n.ys(),e):{xs:l,ys:h}},e.distanceMatrix=function(){return v},e.data=function(n){return arguments.length?(c=n.x.length,g=n.y.length,C.clearRect(0,0,A.width,A.height),A.width=c,A.height=g,r(n),e):d},e.highlight=function(n){if(U=!0,!arguments.length||!n)return i(),void 0;for(var t,r,e,a,o=x,u=v,f=[255,0,0],l=0;g>l;l++)for(var h=l;c>h;h++)t=c*l+h,r=c*h+l,a=u[t]<=E?255:0,e=1===n[l]&&1===n[h],o[t]=e===!0?255<<24|.5*(a+f[2])<<16|.5*(a+f[1])<<8|.5*(a+f[0]):255<<24|a<<16|a<<8|a,o[r]=o[t];i()},e},u.toimg=function(n,t,r,e,a,o){var u,i,f,l,h;for(u=0;e-1>u;u++)for(t[u*r+u]=-1,i=u+1;r>i;i++)f=u*r+i,h=n[f]<=a?255:0,h>0&&(o[u]=1,o[i]=1),t[f]=255<<24|h<<16|h<<8|h,l=i*r+u,t[l]=t[f];t[u*r+u]=-1},u.norms={l1:t,l2:r,max:e,min:a,edit:o},u.rqa=function(n,t,r){var e,a,o,u,c,g,m,d,v,p=1,y=1,b=s(n,r),w=f(b,t),x=new Uint8Array(b.buffer.slice()),M=l(b,t),A=h(x,t),U=2*w/(t*t-t),q=0,C=0,E=0,I=0;for(e=0;t>e;e++)p>e?q+=(e+1)*M[e]:E+=M[e];for(e=0;t>e;e++)y>e?C+=(e+1)*A[e]:I+=A[e];o=w?(w-q)/w:0,m=w?(w-C)/w:0,c=E?(w-q)/E:0,d=I?(w-C)/I:0,g=i(M),v=i(A);var R=0;for(e=p;t>e;e++)a=M[e],a>0&&(R+=a/E*Math.log(a/E));return u=-R,{rr:U,det:o,entropy:u,l:c,lmax:g,lam:m,tt:d,vmax:v}},u.rr=function(n,t,r){var e=s(n,r);return f(e,t)/(t*t-t)},u.det=function(n,t,r){var e=s(n,r),a=l(e,t),o=f(e,t);return(o-2*a[0])/o},u.entropy=function(n,t,r){for(var e,a=s(n,r),o=l(a,t),u=0,i=2,f=i-1,h=0;f<o.length;f++)u+=o[f];for(f=i-1;f<o.length;f++)e=o[f],e>0&&(h+=e/u*Math.log(e/u));return-h};var i=function(n){var t,r=n.length;for(t=r-1;t>=0;t--)if(n[t])return t+1},f=function(n,t){var r,e,a=0;for(r=0;t-1>r;r++)for(e=r+1;t>e;e++)a+=n[r*t+e];return a},l=function(n,t){var r,e,a,o,u=stat.uint32Array(t,0);for(e=0;t-1>e;e++)for(a=e+1;t>a;a++)o=e*t+a,1===n[o]&&(n[o]=0,r=1,r+=g(n,e+1,a+1,t),u[r-1]++);return u},h=function(n,t){var r,e,a,o,u=stat.uint32Array(t,0);for(e=0;t-1>e;e++)for(a=e+1;t>a;a++)o=e*t+a,1===n[o]&&(n[o]=0,r=1,r+=c(n,e+1,a,t),u[r-1]++);return u},c=function(n,t,r,e){var a,o,u=r-1,i=0;for(a=0;u>a&&(o=t*e+r,1===n[o]);a++,t++)i++,n[o]=0;return i},g=function(n,t,r,e){for(var a,o=e-r,u=0,i=0;o>i&&(a=t*e+r,1===n[a]);i++,t++,r++)u++,n[a]=0;return u},s=function(n,t){for(var r=n.length,e=stat.uint8Array(r,0),a=0;r>a;a++)e[a]=n[a]<=t?1:0;return e};"function"==typeof define&&define.amd?define(u):"object"==typeof module&&module.exports?module.exports=u:this.rep=u}();