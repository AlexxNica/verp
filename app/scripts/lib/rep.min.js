!function(){function n(n,t,r){var e,a,o=t.x,u=t.y,i=o.length,f=u.length;for(e=0;f>e;e++)for(a=0;i>a;a++)n[i*e+a]=r(o[e],u[a]);return n}function t(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=0;for(r=0;e>r;r++)a+=Math.abs(n[r]-t[r]);return a}function r(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=0;for(r=0;e>r;r++)a+=(n[r]-t[r])*(n[r]-t[r]);return Math.sqrt(a)}function e(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=[];for(r=0;e>r;r++)a.push(Math.abs(n[r]-t[r]));return Math.max.apply(null,a)}function a(n,t){if("number"==typeof n)return Math.abs(n-t);var r,e=n.length,a=[];for(r=0;e>r;r++)a.push(Math.abs(n[r]-t[r]));return Math.min.apply(null,a)}function o(n,t){var r,e=n.length,a=0;for(r=0;e>r;r++)a+=n[r]===t[r]?0:1;return a}var u={version:"1.0.0"};u.crp=function(){function t(n,t){for(var r=n.length,e=0;r>e;++e)n[e]=t}function r(n){var t=g*c;d=n,v=new Float32Array(t),s=new Uint8Array(g),m=new Uint8Array(g),p=!0,b=new ArrayBuffer(4*t),x=new Uint8ClampedArray(b),w=new Uint32Array(b),q.globalCompositeOperation="source-over",q.imageSmoothingEnabled=!1,E.imageSmoothingEnabled=!1,y=E.getImageData(0,0,g,c)}function e(n,t){return g=t.x.length,c=t.y.length,A=document.createElement("canvas"),A.width=g,A.height=c,E=A.getContext("2d"),M=n.append("canvas").attr("width",H).attr("height",R).node(),q=M.getContext("2d"),q.translate(0,M.height),q.scale(1,-1),r(t),f(),i(),e}function a(){y.data.set(x),E.putImageData(y,0,0),C=!1}function o(){v=n(v,d,U),t(m,0),u.toimg(v,w,g,c,I,m),p=!1,C=!0}function i(){p===!0&&o(),C===!0&&a();var n=l.domain(),t=l.range(),r=h.domain(),e=h.range();q.clearRect(0,0,M.width,M.height),q.drawImage(A,n[0],r[0],n[1]-n[0],r[1]-r[0],t[0],e[0],t[1]-t[0],e[1]-e[0])}function f(){l=d3.scale.linear().domain([0,g]).range([0,H]),h=d3.scale.linear().domain([0,c]).range([0,R])}var l,h,g,c,s,m,d=null,v=null,p=!0,y=null,b=null,x=null,w=null,M=null,A=null,C=!0,q=null,E=null,I=.5,U=u.norms.l2,H=100,R=100;return e.rqa=function(){return v?u.rqa(v,d.x.length,I):void 0},e.epsnet=function(){return m},e.patternHighlight=function(n){if(C=!0,!arguments.length||!n)return i(),s;t(s,0);for(var r,e,a,o,u=w,f=v,l=[255,0,0],h=0;c-1>h;h++)for(var m=h+1;g>m;m++)r=g*h+m,e=g*m+h,o=f[r]<=I?255:0,a=2===n[r],a&&(s[m]=s[h]=1),u[r]=a?255<<24|.5*(o+l[2])<<16|.5*(o+l[1])<<8|.5*(o+l[0]):255<<24|o<<16|o<<8|o,u[e]=u[r];return i(),s},e.resetHighlight=function(){return C=!0,t(s,0),u.toimg(v,w,g,c,I,m),i(),s},e.boxHighlight=function(n){if(C=!0,!arguments.length)return i(),s;t(s,0);var r,e,a,o,u,f=n[0][0]-.5,l=n[0][1]-.5,h=n[1][0]-.5,m=n[1][1]-.5,d=w,p=v,y=[255,0,0];for(o=0;c>o;o++)for(u=0;g>u;u++)r=g*o+u,a=p[r]<=I?255:0,e=!(l>o||o>m||f>u||u>h),e&&(s[u]=s[o]=1),d[r]=e===!0?255<<24|.5*(a+y[2])<<16|.5*(a+y[1])<<8|.5*(a+y[0]):255<<24|a<<16|a<<8|a;return i(),s},e.update=function(){return null!==d&&i(),e},e.distfn=function(n){if(!arguments.length)return U;var t=typeof n;return"string"===t?(U="undefined"!==u.norms[n]?u.norms[n]:u.norms.l2,p=!0):"function"===t?(U=n,p=!0):(console.warn("Incorrect form of the distance function!"),console.warn("Reverting back to the default, Euclidean distance")),e},e.eps=function(n){return arguments.length?(I=+n,p=!0,e):I},e.width=function(n){return arguments.length?(H=+n,e):H},e.height=function(n){return arguments.length?(R=+n,e):R},e.scale=function(n){return arguments.length?(l=n.xs(),h=n.ys(),e):{xs:l,ys:h}},e.distanceMatrix=function(){return v},e.data=function(n){return arguments.length?(g=n.x.length,c=n.y.length,E.clearRect(0,0,A.width,A.height),A.width=g,A.height=c,r(n),e):d},e.highlight=function(n){if(C=!0,!arguments.length||!n)return i(),void 0;for(var t,r,e,a,o=w,u=v,f=[255,0,0],l=0;c>l;l++)for(var h=l;g>h;h++)t=g*l+h,r=g*h+l,a=u[t]<=I?255:0,e=1===n[l]&&1===n[h],o[t]=e===!0?255<<24|.5*(a+f[2])<<16|.5*(a+f[1])<<8|.5*(a+f[0]):255<<24|a<<16|a<<8|a,o[r]=o[t];i()},e},u.toimg=function(n,t,r,e,a,o){var u,i,f,l,h;for(u=0;e-1>u;u++)for(t[u*r+u]=-1,i=u+1;r>i;i++)f=u*r+i,h=n[f]<=a?255:0,h>0&&(o[u]=1,o[i]=1),t[f]=255<<24|h<<16|h<<8|h,l=i*r+u,t[l]=t[f];t[u*r+u]=-1},u.norms={l1:t,l2:r,max:e,min:a,edit:o},u.rqa=function(n,t,r){var e,a,o,u,c,s,m,v,p,y=1,b=1,x=d(n,r),w=f(x,t),M=stat.uint8ArrayCopy(x),A=stat.uint8ArrayCopy(x),C=l(x,t),q=h(M,t),E=(g(A,t),2*w/(t*t-t)),I=0,U=0,H=0,R=0;for(e=0;t>e;e++)y>e?I+=(e+1)*C[e]:H+=C[e];for(e=0;t>e;e++)b>e?U+=(e+1)*q[e]:R+=q[e];o=w?(w-I)/w:0,m=w?(w-U)/w:0,c=H?(w-I)/H:0,v=R?(w-U)/R:0,s=i(C),p=i(q);var D=0;for(e=y;t>e;e++)a=C[e],a>0&&(D+=a/H*Math.log(a/H));return u=-D,{rr:E,det:o,entropy:u,l:c,lmax:s,lam:m,tt:v,vmax:p,dl:x,vl:M,hl:A}},u.rr=function(n,t,r){var e=d(n,r);return f(e,t)/(t*t-t)},u.det=function(n,t,r){var e=d(n,r),a=l(e,t),o=f(e,t);return(o-2*a[0])/o},u.entropy=function(n,t,r){for(var e,a=d(n,r),o=l(a,t),u=0,i=2,f=i-1,h=0;f<o.length;f++)u+=o[f];for(f=i-1;f<o.length;f++)e=o[f],e>0&&(h+=e/u*Math.log(e/u));return-h};var i=function(n){var t,r=n.length;for(t=r-1;t>=0;t--)if(n[t])return t+1},f=function(n,t){var r,e,a=0;for(r=0;t-1>r;r++)for(e=r+1;t>e;e++)a+=n[r*t+e];return a},l=function(n,t){var r,e,a,o,u=stat.uint32Array(t,0);for(e=0;t-1>e;e++)for(a=e+1;t>a;a++)o=e*t+a,1===n[o]&&(n[o]=0,r=1,r+=m(n,e+1,a+1,t),n[o]=r>1?2:0,u[r-1]++);return u},h=function(n,t){var r,e,a,o,u=stat.uint32Array(t,0);for(e=0;t-1>e;e++)for(a=e+1;t>a;a++)o=e*t+a,1===n[o]&&(n[o]=0,r=1,r+=s(n,e+1,a,t),n[o]=r>1?2:0,u[r-1]++);return u},g=function(n,t){var r,e,a,o,u=stat.uint32Array(t,0);for(e=0;t-1>e;e++)for(a=e+1;t>a;a++)o=e*t+a,1===n[o]&&(r=1,n[o]=0,r+=c(n,e,a+1,t),n[o]=r>1?2:0,u[r-1]++);return u},c=function(n,t,r,e){for(var a,o=e-r,u=0,i=0;o>i&&(a=t*e+r,1===n[a]);i++,r++)u++,n[a]=2;return u},s=function(n,t,r,e){var a,o,u=r-t,i=0;for(a=0;u>a&&(o=t*e+r,1===n[o]);a++,t++)i++,n[o]=2;return i},m=function(n,t,r,e){for(var a,o=e-r,u=0,i=0;o>i&&(a=t*e+r,1===n[a]);i++,t++,r++)u++,n[a]=2;return u},d=function(n,t){for(var r=n.length,e=stat.uint8Array(r,0),a=0;r>a;a++)e[a]=n[a]<=t?1:0;return e};"function"==typeof define&&define.amd?define(u):"object"==typeof module&&module.exports?module.exports=u:this.rep=u}();